-- Load OrionLib
local OrionLib = loadstring(game:HttpGet("https://raw.githubusercontent.com/Giangplay/Script/main/Orion_Library_PE_V2.lua"))()

-- Check if OrionLib loaded successfully
if not OrionLib then
    warn("Failed to load OrionLib")
    return
end

print("OrionLib loaded successfully.")

-- Get the number of players in the server
local function getPlayerCount()
    return #game.Players:GetPlayers()
end

-- Create the main window with the "Player Executor" title
local Window = OrionLib:MakeWindow({
    Name = "Player Executor - Slap Battles Hub | Players: " .. getPlayerCount(), -- Display Player Count
    HidePremium = false,
    SaveConfig = true,
    ConfigFolder = "SlapBattlesHub"
})

-- Check if the Window is created
if not Window then
    warn("Failed to create the window!")
    return
end

print("Window created successfully.")

-- Wait a moment for UI to load and check for the window's visibility
wait(1)

-- Ensure that the window is visible (check the UI component directly)
local OrionUI = game:GetService("CoreGui"):FindFirstChild("OrionUI")
if not OrionUI then
    warn("OrionUI is not found in CoreGui. The UI might not be visible.")
    return
else
    print("OrionUI is visible in CoreGui.")
end

-- Create Main Tab
local MainTab = Window:MakeTab({
    Name = "Main",
    Icon = "rbxassetid://4483345998",
    PremiumOnly = false
})

-- Check if the Main Tab is created successfully
if not MainTab then
    warn("Failed to create the Main Tab!")
    return
end

print("Main Tab created successfully.")

-- Add the Test Button to MainTab
MainTab:AddButton({
    Name = "Test Button",
    Callback = function()
        OrionLib:MakeNotification({
            Name = "Test",
            Content = "Button clicked successfully!",
            Image = "rbxassetid://4483345998",
            Time = 3
        })
        print("Test Button clicked!")
    end
})

-- Add a function to update the player count in the window title
local function updatePlayerCount()
    Window:SetName("Player Executor - Slap Battles Hub | Players: " .. getPlayerCount())
end

-- Update player count every 5 seconds
while true do
    updatePlayerCount()
    wait(5)  -- Update every 5 seconds
end

-- Spam Sword Button in Main Tab
local swordSpamRunning = false
local swordSpamThread

MainTab:AddButton({
    Name = "Spam Sword",
    Callback = function()
        if swordSpamRunning then
            OrionLib:MakeNotification({
                Name = "Spam Sword",
