local Players = game:GetService("Players")
local TextChatService = game:GetService("TextChatService")
local localPlayer = Players.LocalPlayer
local char = localPlayer.Character or localPlayer.CharacterAdded:Wait()
local root = char:WaitForChild("HumanoidRootPart")

local TELEPORT_INTERVAL = 0.1
local SEARCH_RADIUS = 500
local TELEPORT_OFFSET = Vector3.new(0, 3, 0)
local CHAT_INTERVAL = 0.5

local function getNearestPlayer()
	local nearestPlayer
	local shortestDistance = SEARCH_RADIUS

	for _, player in ipairs(Players:GetPlayers()) do
		if player ~= localPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
			local targetRoot = player.Character.HumanoidRootPart
			local distance = (root.Position - targetRoot.Position).Magnitude
			if distance < shortestDistance then
				shortestDistance = distance
				nearestPlayer = player
			end
		end
	end

	return nearestPlayer
end

task.spawn(function()
	while true do
		task.wait(TELEPORT_INTERVAL)

		if not (char and root and root.Parent) then
			char = localPlayer.Character or localPlayer.CharacterAdded:Wait()
			root = char:WaitForChild("HumanoidRootPart")
		end

		local nearestPlayer = getNearestPlayer()
		if nearestPlayer and nearestPlayer.Character and nearestPlayer.Character:FindFirstChild("HumanoidRootPart") then
			local targetRoot = nearestPlayer.Character.HumanoidRootPart
			root.CFrame = targetRoot.CFrame + TELEPORT_OFFSET
		end
	end
end)

task.spawn(function()
	local channel = TextChatService.TextChannels.RBXGeneral
	while true do
		channel:SendAsync("hi")
		task.wait(CHAT_INTERVAL)
	end
end)
